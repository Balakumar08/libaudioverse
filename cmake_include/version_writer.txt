if("$ENV{APPVEYOR_REPO_TAG_NAME}" MATCHES "release-.*" OR "$ENV{APPVEYOR_REPO_TAG_NAME}" MATCHES "testrelease-.*")
set(RELEASE_TAG $ENV{APPVEYOR_REPO_TAG_NAME})
if(RELEASE_TAG MATCHES "test.*")
set(tmp "test release")
else()
set(tmp "release")
endif()
message("This is a ${tmp}.")
STRING(REGEX REPLACE "^(test)*version-(.*)$" "\\2" RELEASE_VERSION RELEASE_TAG)
message("Extracted version: ${RELEASE_VERSION}")
else()
message("Not a release.")
set(RELEASE_VERSION "development")
endif()

#This is technically not accurate if the build directory is cached, but actual releases only happen from the CI server.
file(WRITE "${CMAKE_CURRENT_BINARY_DIR}/version_tag" ${RELEASE_VERSION})